/*============================================================================*/
/*  版权声明 : Copyright (c) 1998-2008 中兴通讯股份有限公司传输北京软件开发部 */
/*  系统名称 : ZXONE 8600光传输系统                                           */
/*  文 件 名 : Queue.c                                                        */
/*  功能描述 :                                                                */
/*  创 建 人 : 胡永福                                                         */
/*  文件版本 : V1.00.001                                                      */
/*  创建日期 : 2014.11.24                                                     */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期         版本            修改人          修改摘要                     */
/*============================================================================*/

/*============================================================================*/
/* 包含的标准库或者其他非标准库头文件                                         */
/*============================================================================*/
#include <stdlib.h>
#include <stdio.h>

#include "VarType.h"
#include "MemoryPool.h"
#include "Queue.h"
/*============================================================================*/
/* 本文件使用的常量定义                                                       */
/*============================================================================*/

/*============================================================================*/
/* 本文件使用的宏定义                                                         */
/*============================================================================*/

/*============================================================================*/
/* 本文件使用的数据类型                                                       */
/*============================================================================*/

/*============================================================================*/
/* 全局变量                                                                   */
/*============================================================================*/

/*============================================================================*/
/* 本文件使用的变量                                                           */
/*============================================================================*/

/*============================================================================*/
/* 类的实现                                                                   */
/*============================================================================*/

/*============================================================================*/
/*  函数名 : Queue_Init                                                       */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
Queue *Queue_Init(void)
{
	Queue *pqueue = (Queue *)MemPool_Malloc(sizeof(Queue));

	if(pqueue != NULL)
	{
		pqueue->front = NULL;
		pqueue->rear = NULL;
		pqueue->size = 0;
	}
	
	return pqueue;
}

/*============================================================================*/
/*  函数名 : Queue_Destroy                                                    */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
void Queue_Destroy(Queue *pqueue)
{
	if (Queue_IsEmpty(pqueue)!=1)
	{
		Queue_Clear(pqueue);
    }
    
	MemPool_Free(pqueue);
}

/*============================================================================*/
/*  函数名 : Queue_Clear                                                      */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
void Queue_Clear(Queue *pqueue)
{
	while (Queue_IsEmpty(pqueue) != 1)
	{
		Queue_Pop(pqueue,NULL);
	}

    return;
}

/*============================================================================*/
/*  函数名 : Queue_IsEmpty                                                    */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
UINT32 Queue_IsEmpty(Queue *pqueue)
{
	if (pqueue->front == NULL && pqueue->rear == NULL && pqueue->size == 0)
	{
		return 1;
    }
	else
	{
		return 0;
    }
}

/*============================================================================*/
/*  函数名 : Queue_GetSize                                                    */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
UINT32 Queue_GetSize(Queue *pqueue)
{
	return pqueue->size;
}

/*============================================================================*/
/*  函数名 : Queue_GetFront                                                   */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
PNode Queue_GetFront(Queue *pqueue, void **pitem)
{
	if (Queue_IsEmpty(pqueue) != 1 && pitem != NULL && *pitem != NULL)
	{
		*pitem = pqueue->front->data;
	}
	
	return pqueue->front;
}

/*============================================================================*/
/*  函数名 : Queue_GetRear                                                    */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
PNode Queue_GetRear(Queue *pqueue, void **pitem)
{
	if (Queue_IsEmpty(pqueue) != 1 && pitem != NULL)
	{
		*pitem = pqueue->rear->data;
	}
	
	return pqueue->rear;
}

/*============================================================================*/
/*  函数名 : Queue_Push                                                       */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
PNode Queue_Push(Queue *pqueue, void *pitem)
{
	PNode pnode = (PNode)MemPool_Malloc(sizeof(Node));
	
	if(pnode != NULL)
	{
		pnode->data = pitem;
		pnode->Next = NULL;
		
		if(Queue_IsEmpty(pqueue))
		{
			pqueue->front = pnode;
		}
		else
		{
			pqueue->rear->Next = pnode;
		}
		
		pqueue->rear = pnode;
		pqueue->size++;
	}
	
	return pnode;
}

/*============================================================================*/
/*  函数名 : Queue_Pop                                                        */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
PNode Queue_Pop(Queue *pqueue,void **pitem)
{
	PNode pnode = pqueue->front;
	
	if (Queue_IsEmpty(pqueue) != 1 && pnode != NULL)
	{
		if (pitem != NULL)
		{
			*pitem = pnode->data;
        }
        
		pqueue->size--;
		pqueue->front = pnode->Next;
		MemPool_Free(pnode);
		
		if (pqueue->size == 0)
		{
			pqueue->rear = NULL;
        }
	}
	
	return pqueue->front;
}

/*============================================================================*/
/*  函数名 : Queue_Traverse                                                   */
/*  输  入 : 输入参数或结构的说明                                             */
/*  输  出 : 无                                                               */
/*  返回值 : 执行结果: 0-成功, 非0-失败                                       */
/*  描  述 : 函数功能描述                                                     */
/*  作  者 : 胡永福                                                           */
/*  版  本 : V1.00.001                                                        */
/*  日  期 : 2014.11.24                                                       */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期            版本            修改人          修改摘要                  */
/*============================================================================*/
void Queue_Traverse(Queue *pqueue,void (*visit)())
{
	PNode pnode = pqueue->front;
	int i = pqueue->size;
	
	while (i--)
	{
		visit(pnode->data);
		pnode = pnode->Next;
	}

    return;
}

