/*============================================================================*/
/*  版权声明 : Copyright (c) 1998-2008 中兴通讯股份有限公司传输北京软件开发部 */
/*  系统名称 : ZXONE 8600光传输系统                                           */
/*  文 件 名 : WebSocketMsgParse.h                                            */
/*  功能描述 :                                                                */
/*  创 建 人 : 胡永福                                                         */
/*  文件版本 : V1.00.00                                                       */
/*  创建日期 : 2014.12.25                                                     */
/*============================================================================*/
/*  修改记录                                                                  */
/*  日期         版本            修改人          修改摘要                     */
/*============================================================================*/
#ifndef _WEBSOCKETMSGPARSE_H
#define _WEBSOCKETMSGPARSE_H

/*============================================================================*/
/* 包含的标准库或者其他非标准库头文件                                         */
/*============================================================================*/

/*============================================================================*/
/* 常量定义                                                                   */
/*============================================================================*/

/*============================================================================*/
/* 全局宏                                                                     */
/*============================================================================*/
enum
{
    WEBSOCKET_STATUS_IDLE,
    WEBSOCKET_STATUS_SHAKE_OK,
    WEBSOCKET_STATUS_TRANS_DATA
};
/*============================================================================*/
/* 全局数据类型                                                               */
/*============================================================================*/
typedef struct
{
    char *p;
    int L;
}TPL;

typedef struct
{
    TPL Get;
    TPL Host;
    TPL Upgrade;
    TPL Connection;
    TPL Sec_WebSocket_Key;
    TPL Origin;
    TPL Sec_WebSocket_Protocol;
    TPL Sec_WebSocket_Version;
}TWebSocketHandShake;

typedef struct
{
    UINT32 FIN;
    UINT32 RSV1, RSV2, RSV3;
    UINT32 OpCode;
    UINT32 MASK;
    ULong PayloadLength;
    UINT32 Masking_key;
    UINT8 *PayloadData;
}TWebSocketDataFrame;
/*============================================================================*/
/* 类定义                                                                     */
/*============================================================================*/

/*============================================================================*/
/* 模板(template)(包括C++中的类模板和函数模板)                                */
/*============================================================================*/

/*============================================================================*/
/* 全局函数原型                                                               */
/*============================================================================*/
TProtocalParse WS_MsgParse(INT32 Fd, UINT8 *pWSMsg);

UINT32 WS_init(UINT32 MaxClientNum);

#endif

